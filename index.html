<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="××¢×§×‘ ×¢×‘×•×“×”">
    <title>××¢×§×‘ ×©×¢×•×ª ×¢×‘×•×“×”</title>
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#ffffff">
    
    <!-- × ×’×–×¨×•×ª ×œ-iOS (×—×©×•×‘×•×ª ×‘××™×•×—×“ ×œÖ¾"standalone" ×‘××›×©×™×¨×™ iOS) -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <link rel="apple-touch-icon" href="icons/apple-touch-icon.png">

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            padding-bottom: 40px;
        }

        .container {
            max-width: 500px;
            margin: 0 auto;
        }

        .header {
            text-align: center;
            color: white;
            margin-bottom: 30px;
        }

        .header h1 {
            font-size: 28px;
            margin-bottom: 5px;
        }

        .header p {
            font-size: 14px;
            opacity: 0.9;
        }

        .card {
            background: white;
            border-radius: 20px;
            padding: 25px;
            margin-bottom: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }

        .input-group {
            margin-bottom: 20px;
        }

        .input-group label {
            display: block;
            font-size: 14px;
            font-weight: 600;
            margin-bottom: 8px;
            color: #333;
        }

        .input-group input,
        .input-group select {
            width: 100%;
            padding: 12px 15px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            font-size: 16px;
            transition: border-color 0.3s;
            font-family: inherit;
        }

        .input-group input:focus,
        .input-group select:focus {
            outline: none;
            border-color: #667eea;
        }

        .rate-selector {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .rate-option {
            flex: 1;
            padding: 12px;
            border: 2px solid #e0e0e0;
            border-radius: 12px;
            text-align: center;
            cursor: pointer;
            transition: all 0.3s;
            font-weight: 600;
        }

        .rate-option.active {
            background: #667eea;
            color: white;
            border-color: #667eea;
        }

        .btn {
            width: 100%;
            padding: 15px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 12px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .btn:active {
            transform: scale(0.98);
        }

        .result {
            background: #f8f9ff;
            padding: 20px;
            border-radius: 12px;
            margin-top: 20px;
        }

        .result-item {
            display: flex;
            justify-content: space-between;
            padding: 10px 0;
            border-bottom: 1px solid #e0e0e0;
        }

        .result-item:last-child {
            border-bottom: none;
            font-size: 20px;
            font-weight: 700;
            color: #667eea;
        }

        .result-label {
            color: #666;
        }

        .result-value {
            font-weight: 600;
            color: #333;
        }

        .history {
            max-height: 400px;
            overflow-y: auto;
        }

        .history-item {
            background: #f8f9ff;
            padding: 15px;
            border-radius: 12px;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .history-info {
            flex: 1;
        }

        .history-date {
            font-weight: 600;
            color: #333;
            margin-bottom: 5px;
        }

        .history-time {
            font-size: 13px;
            color: #666;
        }

        .history-pay {
            font-size: 18px;
            font-weight: 700;
            color: #667eea;
        }

        .delete-btn {
            background: #ff4444;
            color: white;
            border: none;
            padding: 8px 12px;
            border-radius: 8px;
            font-size: 12px;
            cursor: pointer;
            margin-right: 10px;
        }

        .summary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 20px;
            border-radius: 12px;
            margin-bottom: 20px;
        }

        .summary-row {
            display: flex;
            justify-content: space-between;
            padding: 8px 0;
        }

        .summary-value {
            font-size: 22px;
            font-weight: 700;
        }

        .clear-all-btn {
            background: #ff6b6b;
            color: white;
            border: none;
            padding: 12px;
            border-radius: 12px;
            width: 100%;
            font-weight: 600;
            cursor: pointer;
            margin-top: 10px;
        }

        .empty-state {
            text-align: center;
            padding: 40px 20px;
            color: #999;
        }

        .tabs {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
        }

        .tab {
            flex: 1;
            padding: 12px;
            background: rgba(255,255,255,0.2);
            color: white;
            border: none;
            border-radius: 12px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
        }

        .tab.active {
            background: white;
            color: #667eea;
        }
    </style>

</head>
<body>
    <div class="container">
        <div class="header">
            <h1>â±ï¸ ××¢×§×‘ ×©×¢×•×ª ×¢×‘×•×“×”</h1>
            <p>×¢×§×•×‘ ××—×¨ ×”×©×¢×•×ª ×•×”×©×›×¨ ×©×œ×š ×‘×§×œ×•×ª</p>
        </div>

        <div class="tabs">
            <button class="tab active" onclick="showTab('calculator')">××—×©×‘×•×Ÿ</button>
            <button class="tab" onclick="showTab('history')">×”×™×¡×˜×•×¨×™×”</button>
        </div>

        <div id="calculatorTab">
            <div class="card">
                <div class="input-group">
                    <label>×ª××¨×™×š</label>
                    <input type="date" id="workDate">
                </div>

                <div class="input-group">
                    <label>×©×¢×ª ×”×ª×—×œ×”</label>
                    <input type="time" id="startTime">
                </div>

                <div class="input-group">
                    <label>×©×¢×ª ×¡×™×•×</label>
                    <input type="time" id="endTime">
                </div>

                <label style="display: block; margin-bottom: 10px; font-weight: 600;">×ª×¢×¨×™×£ ×œ×©×¢×”</label>
                <div class="rate-selector">
                    <div class="rate-option active" onclick="selectRate(35)">35â‚ª</div>
                    <div class="rate-option" onclick="selectRate(40)">40â‚ª</div>
                </div>

                <button class="btn" onclick="calculateWork()">×—×©×‘ ×•×©××•×¨</button>

                <div id="result" style="display: none;">
                    <div class="result">
                        <div class="result-item">
                            <span class="result-label">×©×¢×•×ª ×¢×‘×•×“×”:</span>
                            <span class="result-value" id="hoursWorked"></span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">×ª×¢×¨×™×£:</span>
                            <span class="result-value" id="rateDisplay"></span>
                        </div>
                        <div class="result-item">
                            <span class="result-label">×¡×”"×› ×œ×ª×©×œ×•×:</span>
                            <span class="result-value" id="totalPay"></span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div id="historyTab" style="display: none;">
            <div class="summary" id="summary"></div>
            <div class="card">
                <div id="historyList"></div>
                <button class="clear-all-btn" onclick="clearAllHistory()" id="clearBtn" style="display: none;">××—×§ ××ª ×›×œ ×”×”×™×¡×˜×•×¨×™×”</button>
            </div>
        </div>
    </div>

    <script>
        let selectedRate = 35;
        let workHistory = JSON.parse(localStorage.getItem('workHistory') || '[]');

        // Set today's date by default
        document.getElementById('workDate').valueAsDate = new Date();

        function selectRate(rate) {
            selectedRate = rate;
            document.querySelectorAll('.rate-option').forEach(opt => {
                opt.classList.remove('active');
            });
            event.target.classList.add('active');
        }

        function calculateWork() {
            const date = document.getElementById('workDate').value;
            const startTime = document.getElementById('startTime').value;
            const endTime = document.getElementById('endTime').value;

            if (!date || !startTime || !endTime) {
                alert('×× × ××œ× ××ª ×›×œ ×”×©×“×•×ª');
                return;
            }

            const start = new Date(`2000-01-01T${startTime}`);
            const end = new Date(`2000-01-01T${endTime}`);
            
            let diff = (end - start) / 1000 / 60 / 60;
            
            // Handle overnight shifts
            if (diff < 0) {
                diff += 24;
            }

            const hours = diff.toFixed(2);
            const pay = (diff * selectedRate).toFixed(2);

            document.getElementById('hoursWorked').textContent = `${hours} ×©×¢×•×ª`;
            document.getElementById('rateDisplay').textContent = `${selectedRate}â‚ª ×œ×©×¢×”`;
            document.getElementById('totalPay').textContent = `${pay}â‚ª`;
            document.getElementById('result').style.display = 'block';

            // Save to history
            const workEntry = {
                id: Date.now(),
                date: date,
                startTime: startTime,
                endTime: endTime,
                hours: parseFloat(hours),
                rate: selectedRate,
                pay: parseFloat(pay)
            };

            workHistory.unshift(workEntry);
            localStorage.setItem('workHistory', JSON.stringify(workHistory));
            
            updateHistory();
        }

        function showTab(tab) {
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            event.target.classList.add('active');

            if (tab === 'calculator') {
                document.getElementById('calculatorTab').style.display = 'block';
                document.getElementById('historyTab').style.display = 'none';
            } else {
                document.getElementById('calculatorTab').style.display = 'none';
                document.getElementById('historyTab').style.display = 'block';
                updateHistory();
            }
        }

        function updateHistory() {
            const historyList = document.getElementById('historyList');
            const summary = document.getElementById('summary');
            const clearBtn = document.getElementById('clearBtn');

            if (workHistory.length === 0) {
                historyList.innerHTML = '<div class="empty-state">××™×Ÿ ×¢×“×™×™×Ÿ ×”×™×¡×˜×•×¨×™×”<br>×”×ª×—×œ ×œ×¢×§×•×‘ ××—×¨ ×”×¢×‘×•×“×” ×©×œ×š!</div>';
                summary.style.display = 'none';
                clearBtn.style.display = 'none';
                return;
            }

            clearBtn.style.display = 'block';
            summary.style.display = 'block';

            // Calculate summaries
            const totalHours = workHistory.reduce((sum, entry) => sum + entry.hours, 0);
            const totalPay = workHistory.reduce((sum, entry) => sum + entry.pay, 0);

            // Last 7 days
            const weekAgo = new Date();
            weekAgo.setDate(weekAgo.getDate() - 7);
            const weekEntries = workHistory.filter(entry => new Date(entry.date) >= weekAgo);
            const weekHours = weekEntries.reduce((sum, entry) => sum + entry.hours, 0);
            const weekPay = weekEntries.reduce((sum, entry) => sum + entry.pay, 0);

            summary.innerHTML = `
                <div class="summary-row">
                    <span>×¡×”"×› ×›×œ ×”×–×× ×™×:</span>
                    <span class="summary-value">${totalPay.toFixed(2)}â‚ª</span>
                </div>
                <div class="summary-row">
                    <span>×¡×”"×› ×©×¢×•×ª:</span>
                    <span>${totalHours.toFixed(2)} ×©×¢×•×ª</span>
                </div>
                <div class="summary-row" style="border-top: 1px solid rgba(255,255,255,0.3); padding-top: 15px; margin-top: 10px;">
                    <span>7 ×™××™× ××—×¨×•× ×™×:</span>
                    <span class="summary-value">${weekPay.toFixed(2)}â‚ª</span>
                </div>
                <div class="summary-row">
                    <span>×©×¢×•×ª ×‘×©×‘×•×¢:</span>
                    <span>${weekHours.toFixed(2)} ×©×¢×•×ª</span>
                </div>
            `;

            historyList.innerHTML = workHistory.map(entry => `
                <div class="history-item">
                    <div class="history-info">
                        <div class="history-date">${formatDate(entry.date)}</div>
                        <div class="history-time">${entry.startTime} - ${entry.endTime} (${entry.hours.toFixed(2)} ×©×¢×•×ª, ${entry.rate}â‚ª/×©×¢×”)</div>
                    </div>
                    <button class="delete-btn" onclick="deleteEntry(${entry.id})">ğŸ—‘ï¸</button>
                    <div class="history-pay">${entry.pay.toFixed(2)}â‚ª</div>
                </div>
            `).join('');
        }

        function formatDate(dateStr) {
            const date = new Date(dateStr);
            const options = { weekday: 'short', year: 'numeric', month: 'short', day: 'numeric' };
            return date.toLocaleDateString('he-IL', options);
        }

        function deleteEntry(id) {
            if (confirm('×œ××—×•×§ ×¨×©×•××” ×–×•?')) {
                workHistory = workHistory.filter(entry => entry.id !== id);
                localStorage.setItem('workHistory', JSON.stringify(workHistory));
                updateHistory();
            }
        }

        function clearAllHistory() {
            if (confirm('×”×× ××ª×” ×‘×˜×•×— ×©×‘×¨×¦×•× ×š ×œ××—×•×§ ××ª ×›×œ ×”×”×™×¡×˜×•×¨×™×”?')) {
                workHistory = [];
                localStorage.setItem('workHistory', JSON.stringify(workHistory));
                updateHistory();
            }
        }

        // Initialize
        updateHistory();
    </script>
</body>
</html>

